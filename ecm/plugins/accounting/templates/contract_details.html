{% extends "base.html" %} {% block headtitle %}{% if contract.title %}{{contract.title}}{% else %}&lt;No Title&gt;{% endif	%}{%endblock %} {% block stylesheets %}
<link rel="stylesheet" type="text/css"
	href="{{ STATIC_URL }}accounting/css/classes.css" />
<link rel="stylesheet" type="text/css"
	href="{{ STATIC_URL }}hr/css/classes.css" />
{% endblock %} {% block breadcrumbs %}
<li><a href="/">Home</a></li>
<li><a href="/accounting">Accounting</a></li>
<li><a href="/accounting/contracts/">Contracts</a></li>
<li class="active"><a
	href="/accounting/contracts/{{ contract.contractID }}/">{% if contract.title %}{{contract.title}}{% else %}&lt;No Title&gt;{% endif	%}</a></li>
{% endblock %} {% block main_content %}
<div class="page-header">
	<h1>Contract Details</h1>
</div>

<div class="row-fluid">
	<div class="span1">
		<img src="{{ STATIC_URL }}accounting/img/{{contract.type|lower}}.png" />
	</div>
	<div class="span2">
		<dl>
			<dt>Title</dt>
			<dd id="contract-title">{% if contract.title %}{{contract.title}}{% else %}&lt;No Title&gt;{% endif	%}</dd>
			<dt>Type</dt>
			<dd id="contract-type">{{contract.type}}</dd>
			<dt>Status</dt>
			<dd class="contract-{{contract.status|lower}}">{{contract.status}}</dd>
			<dt>Availability</dt>
			<dd id="contract-availability">{{contract.availability}}</dd>
			<dt>Date Issued</dt>
			<dd id="contract-dateissued">{{contract.dateIssued}}</dd>
			<dt>Date Expired</dt>
			<dd id="contract-dateexpired">{{contract.dateExpired}}</dd>
			<dt>Date Accepted</dt>
			<dd id="contract-dateaccepted">{{contract.dateAccepted}}</dd>
			<dt>Date Completed</dt>
			<dd id="contract-datecompleted">{{contract.dateCompleted}}</dd>
			<dt>Station (start)</dt>
			<dd id="contract-startstation">{{startStation}}</dd>
			<dt>Station (end)</dt>
			<dd id="contract-endstation">{{endStation}}</dd>
		</dl>
	</div>
	<div class="span2">
		<dl>
				<dt>Time left</dt>
				<dd id="contract-numdays">{{contract.numDays}} days</dd>
				<dt>Price</dt>
				<dd id="contract-price">{{contract.price}} ISK</dd>
				<dt>Reward</dt>
				<dd id="contract-reward">{{contract.reward}} ISK</dd>
				<dt>Collateral</dt>
				<dd id="contract-price">{{contract.collateral}} ISK</dd>
				<dt>Buyout</dt>
				<dd id="contract-price">{{contract.buyout}} ISK</dd>
				<dt>Volume</dt>
				<dd id="contract-price">{{contract.volume}} m&sup3;</dd>
				<dt>Issuer</dt>
				<dd id="contract-issuer">{{issuer|safe}}</dd>
				<dt>Assignee</dt>
				<dd id="contract-assignee">{{assignee}}</dd>
				<dt>Acceptor</dt>
				<dd id="contract-acceptor">{{acceptor}}</dd>
		</dl>
	</div>
</div>

<h3>Contract Items</h3>
<form id="search_form" class="form-search form-inline">
  <div class="btn-toolbar" >
    <input type="text" id="search_text" class="input-medium search-query" value="" />
    <div class="btn-group">
      <a class="btn btn-small" id="search_button"><i class="icon-search"></i> Search</a>
      <a class="btn btn-small" id="clear_search">Reset</a>
    </div>
  </div>
</form>
<div class="span6">
	<table class="table table-bordered table-condensed"
		id="contractitems_table">
		<thead>
			<tr>
				<th class="top" scope="col">Type</th>
				<th class="top" scope="col">Quantity</th>
				<th class="top" scope="col">Raw Quantity</th>
				<th class="top" scope="col">Singleton</th>
				<th class="top" scope="col">Included</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td colspan="{{columns|length}}" class="dataTables_empty">Loading
					data from server...</td>
			</tr>
		</tbody>
	</table>
</div>
{% endblock %} {% block post_javascripts %}
<script>
$(document).ready(function() {
    var table = $('#contractitems_table').dataTable($.extend(true, {}, DATATABLE_DEFAULTS, {
        sAjaxSource: "/accounting/contracts/{{ contract.contractID }}/data/",
        aoColumns: [
            { /* Type*/             sWidth: "2%",  sType: "html" },
            { /* Quantity */          sWidth: "5%",  sType: "string", sClass: "right" },
            { /* Raw Quantity */       sWidth: "5%",  sType: "string", sClass: "center" },
            { /* Singleton */       sWidth: "5%",  sType: "numeric" },
            { /* Included */        sWidth: "5%",  sType: "numeric" }
        ],
        fnRowCallback: function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {
            //return nRow;
        },

        /* this function will be called when the table has to query data to be displayed */
        fnServerData: function ( sSource, aoData, fnCallback ) {

            $.getJSON( sSource, aoData, function (json) {
                fnCallback(json)
            } );
        },
    }));

  /* trigger the search when pressing return in the text field */
    $("#search_form").submit(function(event) {
        event.preventDefault();
        table.fnFilter($("#search_text").val());
    });

    /* trigger the search when clicking the "search" button */
    $("#search_button").click(function() {
        table.fnFilter($("#search_text").val());
    });

    /* reset the search when clicking the "reset" button */
    $("#clear_search").click(function() {
        $("#search_text").val("");
        table.fnFilter("");
    });

    /* disable multi column sorting */
    $('#contractitems_table thead th').click(function(event) {
        if (!$(event.target).hasClass('sorthandle')) {
            event.shiftKey = false;
        }
    });

} );
</script>
{% endblock %}


